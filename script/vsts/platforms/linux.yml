jobs:
  - job: Linux
    dependsOn: GetReleaseVersion
    timeoutInMinutes: 180
    variables:
      ReleaseVersion: $[ dependencies.GetReleaseVersion.outputs['Version.ReleaseVersion'] ]
    pool:
      # This image is used to host the Docker container that runs the build
      vmImage: ubuntu-16.04
    container: ubuntu:trusty

    steps:
      - template: templates/linux-preparation.yml

      - template: templates/cache.yml
        parameters:
          OS: linux

      - template: templates/linux-bootstrap.yml

      - script: script/lint
        displayName: Run linter

      - template: templates/linux-build.yml

      - template: templates/linux-test.yml

      - template: templates/linux-publish.yml
